syntax = "proto3";

package reddit.coreplatform.common.v1;

import "validate/validate.proto";

option go_package = "github.snooguts.net/reddit/thing-api/go/grpc/common/v1";
option java_multiple_files = true;
option java_outer_classname = "AuthProto";
option java_package = "com.reddit.coreplatform.api.common.v1";

// The policy used to determine what permission set an actor should assume
message AuthzPolicy {
  // The user account that the caller wishes to assume. When value is empty, the account id
  // present in the edge context will be used instead. This value must be a valid `t2_{}` thing
  // id or the const value for super user access `__super__`. Only Reddit service accounts
  // can assume super user permissions. Service auth edge context must be present in the request
  // when requesting super user permissions.
  string on_behalf_of = 1 [(validate.rules).string = {pattern: "^(__super__|t2_[a-zA-Z0-9]+)$"}];

  // Enable elevated admin permissions for the caller. Admin mode is restricted to users with the
  // appropriate role. Service accounts cannot enable admin permissions and must escalate to super
  // user permissions instead.
  bool enable_admin = 2;
}
