syntax = "proto3";

package reddit.coreplatform.api.metadata.v1;

import "google/protobuf/descriptor.proto";
import "google/protobuf/duration.proto";

option go_package = "github.snooguts.net/reddit/thing-api/go/api/metadata/v1;metadata";
option java_multiple_files = true;
option java_outer_classname = "MetadataProto";
option java_package = "com.reddit.coreplatform.api.metadata.v1";

extend google.protobuf.EnumValueOptions {
  // This enum option is used to allow us to annotate newer protobuf enums
  // with a description of what their previous value was in the older thrift
  // API. Newer proto enums are not 1:1 mapping of their Thrift counterparts
  // due to differences between the best practices of Thrift and protobuf.
  ThriftEnumAlias thrift_alias = 78010000;
}

// This message represents a legacy Thrift enum const.
message ThriftEnumAlias {
  // The const name for the enum value
  string name = 1;
  // The the ordinal or index number of the enum value
  int32 ordinal = 2;
}

extend google.protobuf.FieldOptions {
  // Metadata describing the usage and behavior of API entity fields
  EntityFieldMetadata entity_field_metadata = 78010001 [deprecated = true];

  // Contains metadata about the thrift equivalent of a field. Used to help assert backward compatibility
  // when mapping protobuf messages to and from their thrift counterpart.
  ThriftFieldMetadata thrift_field_metadata = 78010002;
}

// The thing-api metadata for an entity field. This message is used to encapsulate
// and document information about thing entities.
//
// EntityFieldMetadata in this file has been deprecated, use:
//  https://github.snooguts.net/reddit/reddit-api-metadata
message EntityFieldMetadata {
  option deprecated = true;

  // Level of sensitivity that the data stored in a field should be treated with.
  enum SensitivityLevel {
    option deprecated = true;

    // This is a default vault used to convey the absence of a value.
    SENSITIVITY_LEVEL_UNSPECIFIED = 0;

    // Value to denote fields that should be treated as user PII
    SENSITIVITY_LEVEL_PII = 1;

    // Value to describe fields that are visible to reddit administrators but not
    // publicly visible to users.
    SENSITIVITY_LEVEL_ADMIN = 2;

    // Value to describe fields that are visible to all users regardless of authentication status.
    SENSITIVITY_LEVEL_PUBLIC = 3;
  }

  // The sensitivity level of the data stored in the annotated field
  SensitivityLevel sensitivity_level = 1;

  // An http url to the design doc which documents the purposed and introduction of this field to the API.
  // New fields added by contributors must have this value populated
  string design_doc_url = 2;

  // The maximum duration the contents of this field can be cached or stored. After which, its value
  // must be expunged. This is most commonly used to describe the retention period of fields which store PII.
  google.protobuf.Duration max_retention = 3;
}

// Represents any metadata about the corresponding field in Thrift schema.
message ThriftFieldMetadata {
  // This field denotes if the legacy thrift representation of the annotated field was of type `set`. We use this field
  // to ensure backward compatibility when mapping protobuf messages to and from their thrift counterpart since
  // protobuf does not support the concept of `sets`.
  bool is_set = 1;
}
