syntax = "proto3";

package reddit.xpaymentsplatform.payapi.v1;

import "google/protobuf/timestamp.proto";
import "reddit/xpaymentsplatform/payapi/v1/common.proto";
import "reddit/xpaymentsplatform/payapi/v1/get_subscriptions.proto";

option go_package = "github.snooguts.net/reddit/payments-api/api/xpaymentsplatform/payapipb/v1;payapipb";

// OrderStatusUpdateEvent is a notification about updated order status
message OrderStatusUpdateEvent {
  Order order = 1;
  OrderStatus previous_status = 2;
  RecurringState recurring_state = 3;
}

message RecurringState {
  google.protobuf.Timestamp starts_at = 1;
  google.protobuf.Timestamp trial_ends_at = 2;
  google.protobuf.Timestamp next_renewal_at = 3;
  google.protobuf.Timestamp grace_ends_at = 4;
  google.protobuf.Timestamp ends_at = 5;
}

message SubscriptionStatusUpdateEvent {
  SubscriptionPlan subscription_plan = 1;
  SubscriptionStatus previous_status = 2;
}

message FeatureStatusUpdateEvent {
  string subscription_plan_id = 1;
  Environment environment = 2;
  repeated SubscribedFeature features = 3;
}
